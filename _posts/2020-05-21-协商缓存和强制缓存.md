---
categories:
 - 浏览器
tags:
 - 浏览器
 - HTTP
---
缓存的优点：
- 减少了不必要的数据传输，节省带宽
- 减少服务器的负担，提升网站性能
- 加快了客户端加载网页的速度
- 用户体验友好

缺点：
- 资源如果有更改但是客户端不及时更新会造成用户获取信息滞后

### 强制缓存

`cache-control:max-age={过期时间},public,immutable`

- `cache-control`表示缓存的时间
- `public`表示可以被浏览器和代理服务器缓存
- `private`表示代理服务器不缓存，只有客户端可以缓存资源
- `no-cache`表示跳过设置强缓存，但是不妨碍设置协商缓存；一般如果做了强缓存，只有在强缓存失效了才走协商缓存
- `no-store`表示不缓存，这个会让客户端、服务器都不缓存，也就没有所谓的强缓存、协商缓存
- `immutable`表示用户刷新页面，浏览器也不会发起请求去调取服务，浏览器会直接从本地磁盘或者内存中读取缓存并返回**200状态**

### 协商缓存
协商缓存就是需要客户端和服务器两端进行交互

在response header中设置etag和last-modified

- `etag`:每个文件有一个hash值，改动文件hash就会变动
- `last-modified`：文件修改的时间，精确到秒

协商缓存的总结：
请求资源时，把用户本地该资源的etag同时带到服务端，服务端和最新资源做对比。
- 如果资源没更改，返回304，浏览器读取本地缓存
- 如果资源有更改，返回200，返回最新的资源。

HTTP 1.1中新增etag是为了解决之前只有If-Modified的缺点，主要问题如下：
- 1.某些文件也许会周期性更改，但是内容并不改变，仅仅改变文件的修改时间，这个时候我们并不希望客户端认为这个文件被修改了，而重新get
- 某些文件修改非常频繁，比如在秒以下的时间内修改N次

- 某些服务器不能精确地得到文件的最后修改时间