---
categories:
 - HTTP
tags:
 - HTTP
---

##### 内容协商

含义：是指客户端和服务器端就响应的资源内容进行交涉，然后提供给客户端最为合适的资源。

基准：内容协商会以响应资源的语言、字符集、编码方式等（ `Accept` 、 `Accept-Charset` 、 `Accept-Encoding` 、 `Accept-Language` 、 `Content-Language` ）作为判断的基准。

类型：

* 服务器驱动协商：服务器以请求的首部字段为参考，在服务器端自动处理。
* 客户端驱动协商：用户从浏览器显示的可选项列表中手动选择或利用JS选择。
* 透明协商：上述两种类型的结合。

#### HTTP 状态码

##### 状态码

状态码的职责是表示客户端HTTP请求的返回结果、标记服务器端的处理是否正常、通知出现的错误等。

类别（常用14个，REC2616上40个，附加一起60多个）

| 状态码 | 类别       | 说明                       |
| ------ | ---------- | -------------------------- |
| 1XX    | 信息性     | 接收的请求正在处理         |
| 2XX    | 成功       | 请求正常处理完毕           |
| 3XX    | 重定向     | 需要进行附加操作以完成请求 |
| 4XX    | 客户端错误 | 服务器无法处理请求         |
| 5XX    | 服务器错误 | 服务器处理请求出错         |

##### 2XX

| 状态码                | 含义                                                         |
| --------------------- | ------------------------------------------------------------ |
| 200   OK              | 服务器端正常处理客户端的请求                                 |
| 204   No content      | 请求被成功处理，但是不含也不允许返回任何实体的主体           |
| 206   Partial Content | 客户端进行了范围请求，服务器正常处理，响应报文包含由Content-Range指定范围的实体内容 |

##### 3XX

| 状态码                 | 含义                                                         |
| ---------------------- | ------------------------------------------------------------ |
| 301 Move Permanently   | 永久性重定向，表示请求的资源已被分配新的URI                  |
| 302 Found              | 临时性重定向，已移动的资源对应的URI将来可能还会发生改变      |
| 303 See Other          | 明确表示客户端应采用GET方式获取资源                          |
| 304 Not Modify         | 表示客户端发送附带条件的请求，但未满足条件。不包含任何响应的主体 |
| 307 Temporary Redirect | 临时重定向，遵照浏览器标准，同302                            |

##### 4XX

| 状态码           | 含义                                     |
| :--------------- | ---------------------------------------- |
| 400 Bad Request  | 请求报文中存在语法错误                   |
| 401 Unauthorized | 表示发送的请求需要通过HTTP认证的认证信息 |
| 403 Forbidden    | 表明队请求资源的访问被服务器拒绝了       |
| 404 Not Found    | 表明服务器上无法找到请求的资源           |

###### 5XX

| 状态                      | 含义                                   |
| ------------------------- | -------------------------------------- |
| 500 Internal Server Error | 表明服务器在执行请求时发生错误         |
| 503 Service Unavailable   | 表明服务器暂时处于超负载或正在停机维护 |

#### Web服务器

##### 通信数据转发程序

* 代理

  作用：接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。

  转发时需要附加Via首部字段以标记经过的主机信息。

  优点：利用缓存技术减少网络带宽的流量，阻止内部针对特定网站的访问控制、以获取访问日志等。

  两种基准分类：

  + 是否使用缓存（缓存代理和非缓存代理）
  + 是否会修改报文（透明代理和非透明代理）

* 网关

* 隧道

##### POST和GET操作

先说下安全和幂等的概念

* 在HTTP协议里，安全是指请求方法不会破坏服务器上的资源
* 所谓幂等是多次执行相同的操作，结果都是想等的

很明显GET方法就是安全且幂等的，而POST是不安全也不幂等

#### HTTP PLUS知识

##### HTTP特性

 - HTTP优点

  + 简单
  + 灵活和易于扩展
  + 应用广泛和跨平台

 - HTTP缺点

  + 无状态双刃剑
    - 好处：服务器不需要去记忆HTTP的状态，减少额外开销
    - 坏处：既然服务器没有记忆能力，它在完成有关联性的操作时就会非常麻烦（解决方案：`cookie`）
  + 明文传输双刃剑
    - 可方便阅读
    - 信息裸奔
  + 不安全（被窃听、遭遇伪装、被篡改）

##### HTTP/1.1的特点：

   - 长连接：也叫持久连接，减少了TCP连接的重复建立和断开造成的额外开销，减轻了服务器的负载。只要任意一端没有明确提出断开连接，则保持TCP连接状态
   - 管道网络传输：同一个TCP连接里，客户端可以发起多个请求，不必等其返回，就可以发第二个请求，可以减少整体的响应时间
   - 队头阻塞：服务器按照顺序处理客户端的请求，如果某一个请求被阻塞，则后面的所有请求也一同被阻塞

##### HTTP与HTTPS

  + HTTP与HTTPS的区别

   - HTTP是超文本传输协议，明文传输；HTTPS则解决了HTTP不安全的缺陷，在TCP与HTTP之间加入SSL/TLS安全协议，使得报文加密传输
   - HTTP是三次握手，而HTTPS在TCP三次握手后还需进行SSL/TLS的握手（四次握手），才可进入加密报文传输
   - HTTP端口80，HTTPS端口443
   - HTTPS协议需要向CA（证书权威机构）申请数字证书，来保证服务器的身份是可信的

  + HTTPS是如何保证安全
    - 信息加密
      - 混合加密

       - 通信建立前采用非对称加密的方式交换会话密钥，后续不再使用非对称加密
       - 在通信过程中全部使用对称加密的会话密钥的方式加密明文数据
       > 对称加密只使用一个密钥，运算速度快，密钥必须保密，无法做到安全的密钥交换；而非对称加密使用两个密钥（公钥和私钥），公钥可以任意分发而私钥保密，解决了密钥交换问题但速度慢

    - 校对机制
      - 摘要算法：用来实现完整性，能够为数据生成独一无二的指纹，用于校验数据的完整性，解决了篡改的风险
    - 身份证书
      - 数字证书：客户端先向服务器索要公钥，然后用公钥加密信息，服务器收到密文后，用自己的私钥解密

  + SSL/TLS协议基本流程
    - 客户端向服务器索要并验证服务器的公钥
    - 双方协商生产【会话密钥】
    - 双方采用【会话密钥】进行加密通信 

   

##### HTTP/1.1、HTTP/2、HTTP/3的演变

   HTTP/1.1利用长连接和支持管道传输解决了HTTP/1.0的一些问题，但自身也有性能瓶颈
   - 请求头/响应头部未压缩
   - 每次互相发送冗长的相同的首部造成浪费
   - 队头阻塞问题
   - 没有请求优先级控制
   - 请求只能从客户端开始，服务器只能被动响应
   
   HTTP/2相比HTTP/1.1有所改进
   - 头部压缩：在客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，之后久只发送索引号不发送相同字段
   - 二进制格式：不像HTTP/1.1里的纯文本形式的报文，而是全面采用了二进制格式，头信息和数据体都是二进制，并且统称为帧：头信息帧和数据帧
   - 数据流：数据包不按顺序发送；每个请求或响应的所有的数据包，称为一个数据流，每个数据流都标记着一个独一无二的编号（奇数: 客户端发出，偶数：服务器发出）
   - 多路复用
   - 服务器推送

   HTTP/2的缺陷：多个HTTP请求在复用一个TCP连接，可能会触发TCP的重传机制，造成等待。

   HTTP/3采用UDP替代TCP
